{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _set from \"@babel/runtime/helpers/set\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _wrapNativeSuper from \"@babel/runtime/helpers/wrapNativeSuper\";\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nvar CameraError = function (_Error) {\n  _inherits(CameraError, _Error);\n  var _super = _createSuper(CameraError);\n  function CameraError(code, message, cause) {\n    var _thisSuper, _thisSuper2, _this;\n    _classCallCheck(this, CameraError);\n    _this = _super.call(this, \"[\" + code + \"]: \" + message + (cause != null ? \" (Cause: \" + cause.message + \")\" : ''));\n    _defineProperty(_assertThisInitialized(_this), \"_code\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_message\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"_cause\", void 0);\n    _set((_thisSuper = _assertThisInitialized(_this), _getPrototypeOf(CameraError.prototype)), \"name\", code, _thisSuper, true);\n    _set((_thisSuper2 = _assertThisInitialized(_this), _getPrototypeOf(CameraError.prototype)), \"message\", message, _thisSuper2, true);\n    _this._code = code;\n    _this._message = message;\n    _this._cause = cause;\n    return _this;\n  }\n  _createClass(CameraError, [{\n    key: \"code\",\n    get: function get() {\n      return this._code;\n    }\n  }, {\n    key: \"message\",\n    get: function get() {\n      return this._message;\n    }\n  }, {\n    key: \"cause\",\n    get: function get() {\n      var c = this._cause;\n      if (c == null) return undefined;\n      return new Error(\"[\" + c.code + \"]: \" + c.message);\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      return \"[\" + this.code + \"]: \" + this.message;\n    }\n  }]);\n  return CameraError;\n}(_wrapNativeSuper(Error));\nexport var CameraCaptureError = function (_CameraError) {\n  _inherits(CameraCaptureError, _CameraError);\n  var _super2 = _createSuper(CameraCaptureError);\n  function CameraCaptureError() {\n    _classCallCheck(this, CameraCaptureError);\n    return _super2.apply(this, arguments);\n  }\n  return _createClass(CameraCaptureError);\n}(CameraError);\nexport var CameraRuntimeError = function (_CameraError2) {\n  _inherits(CameraRuntimeError, _CameraError2);\n  var _super3 = _createSuper(CameraRuntimeError);\n  function CameraRuntimeError() {\n    _classCallCheck(this, CameraRuntimeError);\n    return _super3.apply(this, arguments);\n  }\n  return _createClass(CameraRuntimeError);\n}(CameraError);\nexport var isErrorWithCause = function isErrorWithCause(error) {\n  return typeof error === 'object' && error != null && typeof error.message === 'string' && (typeof error.stacktrace === 'string' || error.stacktrace == null) && (isErrorWithCause(error.cause) || error.cause == null);\n};\nvar isCameraErrorJson = function isCameraErrorJson(error) {\n  return typeof error === 'object' && error != null && typeof error.code === 'string' && typeof error.message === 'string' && (typeof error.cause === 'object' || error.cause == null);\n};\nexport var tryParseNativeCameraError = function tryParseNativeCameraError(nativeError) {\n  if (isCameraErrorJson(nativeError)) {\n    if (nativeError.code.startsWith('capture')) {\n      return new CameraCaptureError(nativeError.code, nativeError.message, nativeError.cause);\n    } else {\n      return new CameraRuntimeError(nativeError.code, nativeError.message, nativeError.cause);\n    }\n  } else {\n    return nativeError;\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;IAqHMA,WAAN;EAAA;EAAA;EAoBEC,qBAAYC,IAAD,EAAcC,OAAd,EAA+BC,KAA/B,EAAuD;IAAA;IAAA;IAChE,gCAAUF,IAAK,WAAKC,OAAQ,IAAEC,KAAK,IAAI,IAAT,iBAA4BA,KAAK,CAACD,OAAQ,SAAK,EAAG;IADhBE;IAAAA;IAAAA;IAEhE,mGAAaH,IAAb;IACA,uGAAgBC,OAAhB;IACA,MAAKG,KAAL,GAAaJ,IAAb;IACA,MAAKK,QAAL,GAAgBJ,OAAhB;IACA,MAAKK,MAAL,GAAcJ,KAAd;IAAA;EACD;EAAA;IAAA;IAAA,KAtBc,eAAU;MACvB,OAAO,KAAKE,KAAZ;IACD;EAAA;IAAA;IAAA,KACiB,eAAW;MAC3B,OAAO,KAAKC,QAAZ;IACD;EAAA;IAAA;IAAA,KACe,eAAsB;MACpC,IAAME,CAAC,GAAG,KAAKD,MAAf;MACA,IAAIC,CAAC,IAAI,IAAT,EAAe,OAAOC,SAAP;MACf,OAAO,IAAIC,KAAJ,OAAcF,CAAC,CAACP,IAAK,WAAKO,CAAC,CAACN,OAAQ,CAA3C;IACD;EAAA;IAAA;IAAA,OAcMS,oBAAmB;MACxB,aAAW,KAAKV,IAAK,WAAK,KAAKC,OAAQ;IACxC;EAAA;EAAA;AAAA,mBA/BsDQ,KAAzD;AAuCA,WAAaE,kBAAN;EAAA;EAAA;EAAA;IAAA;IAAA;EAAA;EAAA;AAAA,EAAiCb,WAAjC;AAOP,WAAac,kBAAN;EAAA;EAAA;EAAA;IAAA;IAAA;EAAA;EAAA;AAAA,EAAiCd,WAAjC;AASP,OAAO,IAAMe,gBAAgB,GAAIC,SAApBD,gBAAgB,CAAIC,KAAD;EAAA,OAC9B,OAAOA,KAAP,KAAiB,QAAjB,IACAA,KAAK,IAAI,IADT,IAGA,OAAOA,KAAK,CAACb,OAAb,KAAyB,QAHzB,KAKC,OAAOa,KAAK,CAACC,UAAb,KAA4B,QAA5B,IAAwCD,KAAK,CAACC,UAAN,IAAoB,IAL7D,MAOCF,gBAAgB,CAACC,KAAK,CAACZ,KAAP,CAAhB,IAAiCY,KAAK,CAACZ,KAAN,IAAe,IAPjD,CADK;AAAA;AAUP,IAAMc,iBAAiB,GAAIF,SAArBE,iBAAiB,CAAIF,KAAD;EAAA,OACxB,OAAOA,KAAP,KAAiB,QAAjB,IACAA,KAAK,IAAI,IADT,IAGA,OAAOA,KAAK,CAACd,IAAb,KAAsB,QAHtB,IAKA,OAAOc,KAAK,CAACb,OAAb,KAAyB,QALzB,KAOC,OAAOa,KAAK,CAACZ,KAAb,KAAuB,QAAvB,IAAmCY,KAAK,CAACZ,KAAN,IAAe,IAPnD,CADF;AAAA;AAgBA,OAAO,IAAMe,yBAAyB,GAAOC,SAAhCD,yBAAyB,CAAOC,WAAJ,EAAsE;EAC7G,IAAIF,iBAAiB,CAACE,WAAD,CAArB,EAAoC;IAClC,IAAIA,WAAW,CAAClB,IAAZ,CAAiBmB,UAAjB,CAA4B,SAA5B,CAAJ,EAA4C;MAC1C,OAAO,IAAIR,kBAAJ,CAAuBO,WAAW,CAAClB,IAAnC,EAAyDkB,WAAW,CAACjB,OAArE,EAA8EiB,WAAW,CAAChB,KAA1F,CAAP;IACD,CAFD,MAEO;MACL,OAAO,IAAIU,kBAAJ,CAELM,WAAW,CAAClB,IAFP,EAGLkB,WAAW,CAACjB,OAHP,EAILiB,WAAW,CAAChB,KAJP,CAAP;IAMD;EACF,CAXD,MAWO;IACL,OAAOgB,WAAP;EACD;AACF,CAfM","names":["CameraError","constructor","code","message","cause","_defineProperty","_code","_message","_cause","c","undefined","Error","toString","CameraCaptureError","CameraRuntimeError","isErrorWithCause","error","stacktrace","isCameraErrorJson","tryParseNativeCameraError","nativeError","startsWith"],"sources":["CameraError.ts"],"sourcesContent":["export type PermissionError = 'permission/microphone-permission-denied' | 'permission/camera-permission-denied';\nexport type ParameterError =\n  | 'parameter/invalid-parameter'\n  | 'parameter/unsupported-os'\n  | 'parameter/unsupported-output'\n  | 'parameter/unsupported-input'\n  | 'parameter/invalid-combination';\nexport type DeviceError =\n  | 'device/configuration-error'\n  | 'device/no-device'\n  | 'device/invalid-device'\n  | 'device/parallel-video-processing-not-supported'\n  | 'device/torch-unavailable'\n  | 'device/microphone-unavailable'\n  | 'device/low-light-boost-not-supported'\n  | 'device/focus-not-supported'\n  | 'device/camera-not-available-on-simulator';\nexport type FrameProcessorError = 'frame-processor/unavailable';\nexport type FormatError =\n  | 'format/invalid-fps'\n  | 'format/invalid-hdr'\n  | 'format/invalid-low-light-boost'\n  | 'format/invalid-format'\n  | 'format/invalid-color-space'\n  | 'format/invalid-preset';\nexport type SessionError =\n  | 'session/camera-not-ready'\n  | 'session/audio-session-setup-failed'\n  | 'session/audio-in-use-by-other-app'\n  | 'session/audio-session-failed-to-activate';\nexport type CaptureError =\n  | 'capture/invalid-photo-format'\n  | 'capture/encoder-error'\n  | 'capture/muxer-error'\n  | 'capture/recording-in-progress'\n  | 'capture/no-recording-in-progress'\n  | 'capture/file-io-error'\n  | 'capture/create-temp-file-error'\n  | 'capture/invalid-video-options'\n  | 'capture/create-recorder-error'\n  | 'capture/recorder-error'\n  | 'capture/no-valid-data'\n  | 'capture/inactive-source'\n  | 'capture/insufficient-storage'\n  | 'capture/file-size-limit-reached'\n  | 'capture/invalid-photo-codec'\n  | 'capture/not-bound-error'\n  | 'capture/capture-type-not-supported'\n  | 'capture/video-not-enabled'\n  | 'capture/photo-not-enabled'\n  | 'capture/aborted'\n  | 'capture/unknown';\nexport type SystemError = 'system/no-camera-manager' | 'system/view-not-found';\nexport type UnknownError = 'unknown/unknown';\n\n/**\n * Represents a JSON-style error cause. This contains native `NSError`/`Throwable` information, and can have recursive {@linkcode ErrorWithCause.cause | .cause} properties until the ultimate cause has been found.\n */\nexport interface ErrorWithCause {\n  /**\n   * The native error's code.\n   *\n   * * iOS: `NSError.code`\n   * * Android: N/A\n   */\n  code?: number;\n  /**\n   * The native error's domain.\n   *\n   * * iOS: `NSError.domain`\n   * * Android: N/A\n   */\n  domain?: string;\n  /**\n   * The native error description\n   *\n   * * iOS: `NSError.message`\n   * * Android: `Throwable.message`\n   */\n  message: string;\n  /**\n   * Optional additional details\n   *\n   * * iOS: `NSError.userInfo`\n   * * Android: N/A\n   */\n  details?: Record<string, unknown>;\n  /**\n   * Optional Java stacktrace\n   *\n   * * iOS: N/A\n   * * Android: `Throwable.stacktrace.toString()`\n   */\n  stacktrace?: string;\n  /**\n   * Optional additional cause for nested errors\n   *\n   * * iOS: N/A\n   * * Android: `Throwable.cause`\n   */\n  cause?: ErrorWithCause;\n}\n\ntype CameraErrorCode =\n  | PermissionError\n  | ParameterError\n  | DeviceError\n  | FrameProcessorError\n  | FormatError\n  | SessionError\n  | CaptureError\n  | SystemError\n  | UnknownError;\n\n/**\n * Represents any kind of error that occured in the {@linkcode Camera} View Module.\n */\nclass CameraError<TCode extends CameraErrorCode> extends Error {\n  private readonly _code: TCode;\n  private readonly _message: string;\n  private readonly _cause?: ErrorWithCause;\n\n  public get code(): TCode {\n    return this._code;\n  }\n  public get message(): string {\n    return this._message;\n  }\n  public get cause(): Error | undefined {\n    const c = this._cause;\n    if (c == null) return undefined;\n    return new Error(`[${c.code}]: ${c.message}`);\n  }\n\n  /**\n   * @internal\n   */\n  constructor(code: TCode, message: string, cause?: ErrorWithCause) {\n    super(`[${code}]: ${message}${cause != null ? ` (Cause: ${cause.message})` : ''}`);\n    super.name = code;\n    super.message = message;\n    this._code = code;\n    this._message = message;\n    this._cause = cause;\n  }\n\n  public toString(): string {\n    return `[${this.code}]: ${this.message}`;\n  }\n}\n\n/**\n * Represents any kind of error that occured while trying to capture a video or photo.\n *\n * See the [\"Camera Errors\" documentation](https://mrousavy.github.io/react-native-vision-camera/docs/guides/errors) for more information about Camera Errors.\n */\nexport class CameraCaptureError extends CameraError<CaptureError> {}\n\n/**\n * Represents any kind of error that occured in the Camera View Module.\n *\n * See the [\"Camera Errors\" documentation](https://mrousavy.github.io/react-native-vision-camera/docs/guides/errors) for more information about Camera Errors.\n */\nexport class CameraRuntimeError extends CameraError<\n  PermissionError | ParameterError | DeviceError | FormatError | FrameProcessorError | SessionError | SystemError | UnknownError\n> {}\n\n/**\n * Checks if the given `error` is of type {@linkcode ErrorWithCause}\n * @param {unknown} error Any unknown object to validate\n * @returns `true` if the given `error` is of type {@linkcode ErrorWithCause}\n */\nexport const isErrorWithCause = (error: unknown): error is ErrorWithCause =>\n  typeof error === 'object' &&\n  error != null &&\n  // @ts-expect-error error is still unknown\n  typeof error.message === 'string' &&\n  // @ts-expect-error error is still unknown\n  (typeof error.stacktrace === 'string' || error.stacktrace == null) &&\n  // @ts-expect-error error is still unknown\n  (isErrorWithCause(error.cause) || error.cause == null);\n\nconst isCameraErrorJson = (error: unknown): error is { code: string; message: string; cause?: ErrorWithCause } =>\n  typeof error === 'object' &&\n  error != null &&\n  // @ts-expect-error error is still unknown\n  typeof error.code === 'string' &&\n  // @ts-expect-error error is still unknown\n  typeof error.message === 'string' &&\n  // @ts-expect-error error is still unknown\n  (typeof error.cause === 'object' || error.cause == null);\n\n/**\n * Tries to parse an error coming from native to a typed JS camera error.\n * @param {CameraError} nativeError The native error instance. This is a JSON in the legacy native module architecture.\n * @returns A {@linkcode CameraRuntimeError} or {@linkcode CameraCaptureError}, or the `nativeError` itself if it's not parsable\n * @method\n */\nexport const tryParseNativeCameraError = <T>(nativeError: T): (CameraRuntimeError | CameraCaptureError) | T => {\n  if (isCameraErrorJson(nativeError)) {\n    if (nativeError.code.startsWith('capture')) {\n      return new CameraCaptureError(nativeError.code as CaptureError, nativeError.message, nativeError.cause);\n    } else {\n      return new CameraRuntimeError(\n        // @ts-expect-error the code is string, we narrow it down to TS union.\n        nativeError.code,\n        nativeError.message,\n        nativeError.cause,\n      );\n    }\n  } else {\n    return nativeError;\n  }\n};\n"]},"metadata":{},"sourceType":"module"}